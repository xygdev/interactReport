(function($){$.fn.lovListener=function(){$('input[data-lovname]').on('click',function(e){$(this).lov($(this).data())});$('button[data-lovname]').on('click',function(e){$(this).lov($(this).data())});$('a[data-lovname]').on('click',function(e){e.preventDefault();$(this).lov($(this).data())});$('i[data-lovname]').on('click',function(e){$(this).lov($(this).data())})}$().lovListener();$.fn.lov=function(options){var defaults={lovsetting:'{"defaultquery":"","queryval":"","lovclass":"","title":"","querybox":"","contentbox":"","tablename":"","prevpage":"","nextpage":"","query":"","pageno":"","queryurl":"","jsontype":"","typetd":"","urltd":""}'}var options=$.extend({},defaults,options);return this.each(function(){$.fn.choose=function(){$(options.lovsetting.lovclass+' td').on('click',function(){for(k=0;k<2;k++){text=$(this).parent().children(options.choose[k]).text();if(!text){alert('不能选择空值');return}else{$(options.recid[k]).val(text)}}$(options.lovsetting.lovclass+' .'+options.dismissmodalclass).click()})}$(options.lovsetting.title+' h1').text(options.lovname);$(options.lovsetting.pageno).val('1');$(options.lovsetting.prevpage).css('display','none');$(options.lovsetting.nextpage).css('display','none');$(options.lovsetting.typetd).val(options.lovsetting.jsontype);$(options.lovsetting.urltd).val(options.lovsetting.queryurl);$('table',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).html('');$('table',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).append('<tr>');for(i=0;i!=-1;i++){if(options.th[i]!=null){$('tr:eq(0)',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).append('<th>'+options.th[i]+'</th>')}else{break;return i}}for(m=1;m<=10;m++){$('table',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).append('<tr>');for(n=0;n<i;n++){$('tr:eq('+m+')',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).append('<td class=\''+options.td[n]+'\'></td>')}}$(options.lovsetting.querybox+' select').html('');$(options.lovsetting.queryval).val('');$('table',$(options.lovsetting.lovclass+' '+options.lovsetting.contentbox)).attr('id',options.lovsetting.tablename);for(j=0;j!=-1;j++){if(options.selectname[j]!=null&&options.selectvalue[j]!=null){$(options.lovsetting.querybox+' select').append('<option value='+options.selectvalue[j]+'>'+options.selectname[j]+'</option>')}else{break}}$().choose();if(options.lovsetting.defaultquery==true){$(options.lovsetting.query).click()}width='-'+parseInt($(options.lovsetting.lovclass).css('width'))/2+'px';$(options.lovsetting.lovclass).css('margin-left',width)})}})(jQuery);
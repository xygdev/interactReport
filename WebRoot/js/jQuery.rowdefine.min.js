(function($){$.fn.rowdefineListener=function(){$('button[data-rowdefine]').on('click',function(e){$(this).rowdefine($(this).data())});$('a[data-rowdefine]').on('click',function(e){e.preventDefault();$(this).rowdefine($(this).data())})}$().rowdefineListener();$.fn.rowdefine=function(options){var defaults={definetable:'#tb',setbutton:'#setting',showframe:'#show',hideframe:'#hide'};var options=$.extend({},defaults,options);var lastindex=($(options.definetable+' td').length/($(options.definetable+' tr').length-1))-1;return this.each(function(){if(options.rowdefine=='init'){linenum=($(options.definetable+' tr').length-1);$(options.setbutton).css('visibility','hidden');$(options.showframe).empty();$(options.hideframe).empty();count=$(options.definetable+' th').length-1;for(i=0;i<count;i++){if($(options.definetable+' th:eq('+i+')').css('display')!='none'){$(options.showframe).append('<option value='+$(options.definetable+' th:eq('+i+')').attr('class')+'>'+$(options.definetable+' th:eq('+i+')').text()+'</option>')}else{$(options.hideframe).append('<option value='+$(options.definetable+' th:eq('+i+')').attr('class')+'>'+$(options.definetable+' th:eq('+i+')').text()+'</option>')}}}else if(options.rowdefine=='show'){value=[];linenum=($(options.definetable+' tr').length-1);hiddenindex=($(options.showframe+'  option').length);$(options.hideframe+' option:selected').each(function(){value.push($(this).val())});value=value.reverse();$(options.showframe).append($(options.hideframe+' option:selected'));$(options.hideframe+' option:selected').remove();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();if(rowindex!=hiddenindex){$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq('+hiddenindex+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq('+hiddenindex+')',$(options.definetable+' tr:eq('+j+')')))}}$('.'+value[i]).css('display','')}else{break}}}else if(options.rowdefine=='show_all'){value=[];linenum=($(options.definetable+' tr').length-1);hiddenindex=($(options.showframe+' option').length);$(options.hideframe+' option').each(function(){value.push($(this).val())});value=value.reverse();$(options.showframe).append($(options.hideframe+' option'));$(options.hideframe+' option').remove();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq('+hiddenindex+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq('+hiddenindex+')',$(options.definetable+' tr:eq('+j+')')))}$('.'+value[i]).css('display','')}else{break}}}else if(options.rowdefine=='hide'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option:selected').each(function(){value.push($(this).val())});$(options.hideframe).append($(options.showframe+' option:selected'));$(options.showframe+' option:selected').hide();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq('+lastindex+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq('+lastindex+')',$(options.definetable+' tr:eq('+j+')')))}$('.'+value[i]).css('display','none')}else{break}}}else if(options.rowdefine=='hide_all'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option').each(function(){value.push($(this).val())});$(options.hideframe).append($(options.showframe+' option'));$(options.showframe+' option').remove();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq('+lastindex+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq('+lastindex+')',$(options.definetable+' tr:eq('+j+')')))}$('.'+value[i]).css('display','none')}else{break}}}else if(options.rowdefine=='up'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option:selected').each(function(){value.push($(this).val())});for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();if(rowindex!=0){$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq('+(rowindex-1)+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq('+(rowindex-1)+')',$(options.definetable+' tr:eq('+j+')')))}$(options.showframe+' option:eq('+rowindex+')').insertBefore($(options.showframe+' option:eq('+(rowindex-1)+')'))}else{break}}else{break}}}else if(options.rowdefine=='down'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option:selected').each(function(){value.push($(this).val())});showindex=($(options.showframe+' option').length-1);value=value.reverse();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();if(rowindex!=showindex){$(options.definetable+' th:eq('+rowindex+')').insertAfter($(options.definetable+' th:eq('+(rowindex+1)+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertAfter($('td:eq('+(rowindex+1)+')',$(options.definetable+' tr:eq('+j+')')))}$(options.showframe+' option:eq('+rowindex+')').insertAfter($(options.showframe+' option:eq('+(rowindex+1)+')'))}else{break}}else{break}}}else if(options.rowdefine=='top'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option:selected').each(function(){value.push($(this).val())});value=value.reverse();for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();if(rowindex!=0){$(options.definetable+' th:eq('+rowindex+')').insertBefore($(options.definetable+' th:eq(0)'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertBefore($('td:eq(0)',$(options.definetable+' tr:eq('+j+')')))}$(options.showframe+' option:eq('+rowindex+')').insertBefore($(options.showframe+' option:eq(0)'))}else{break}}else{break}}}else if(options.rowdefine=='bottom'){value=[];linenum=($(options.definetable+' tr').length-1);$(options.showframe+' option:selected').each(function(){value.push($(this).val())});showindex=($(options.showframe+' option').length-1);for(i=0;i!=-1;i++){if(value[i]!=null){rowindex=$('.'+value[i]).index();if(rowindex!=showindex){$(options.definetable+' th:eq('+rowindex+')').insertAfter($(options.definetable+' th:eq('+showindex+')'));for(j=0;j<=linenum;j++){$('td:eq('+rowindex+')',$(options.definetable+' tr:eq('+j+')')).insertAfter($('td:eq('+showindex+')',$(options.definetable+' tr:eq('+j+')')))}$(options.showframe+' option:eq('+rowindex+')').insertAfter($(options.showframe+' option:eq('+showindex+')'))}else{break}}else{break}}}})}})(jQuery);
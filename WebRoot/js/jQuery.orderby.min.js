(function($){$.fn.orderListener=function(){$('a[data-ordertable]').on('click',function(e){e.preventDefault();$(this).orderby($(this).data())});$('button[data-order]').on('click',function(e){$(this).order($(this).data())})}$().orderListener();$.fn.orderby=function(options){var defaults={setframe:'#setting',orderframe:'#orderby',orderpara:'#order_para'}var options=$.extend({},defaults,options);return this.each(function(){lastindex=($(options.ordertable+' td').length/($(options.ordertable+' tr').length-1))-1;$(options.setframe).css('visibility','hidden');$(options.orderframe+' select').html('');$(options.orderframe+' input[value="ASC"]').prop("checked","checked");$(options.orderframe+' select').append('<option value="blank"></option>');for(i=0;i<lastindex;i++){value=$(options.ordertable+' th:eq('+i+')').attr('class');name=$(options.ordertable+' th:eq('+i+')').text();column=$(options.ordertable+' th:eq('+i+')').attr('data-column');if(column=="db"){$(options.orderframe+' select').append('<option value="'+value+'" >'+name+'</option>')}else{continue}}order_by=$(options.orderpara).val();order_group=new Array;order_group=order_by.split(",");order_count=order_group.length;for(i=0;i<order_count;i++){order_detail=new Array;order_detail=order_group[i].split(" ");a=i+1;column='col'+a;$('#'+column+' option[value="'+order_detail[0]+'"]').prop('selected',true);$('#'+column+' input[value="'+order_detail[1]+'"]').prop("checked","checked")}})}$.fn.order=function(options){var defaults={col1:'col1',col2:'col2',col3:'col3',orderpara:'#order_para',pageno:'#page_no',refresh:'#refresh',orderframe:'#orderby'}var options=$.extend({},defaults,options);return this.each(function(){if(options.order==true){orderby=null;col1=$('#'+options.col1+' option:selected').val();col2=$('#'+options.col2+' option:selected').val();col3=$('#'+options.col3+' option:selected').val();if(col1!='blank'){order1=$('input[name="'+options.col1+'"]:checked ').val();orderby=col1+' '+order1;if(col2!='blank'){order2=$('input[name="'+options.col2+'"]:checked ').val();orderby=orderby+','+col2+' '+order2;if(col3!='blank'){order3=$('input[name="'+options.col3+'"]:checked ').val();orderby=orderby+','+col3+' '+order3}}else{if(col3!='blank'){alert('排序二不能为空！');return}}}else{if(col2=='blank'){if(col3=='blank'){alert('排序不能为空！')}else{alert('排序一，排序二不能为空！')}}else{alert('排序一不能为空！')}}if(orderby!=null){$(options.orderpara).val(orderby);$(options.pageno).val(1);$(options.refresh).click();$(options.orderframe+' .close-reveal-modal').click()}}else{alert('多维排序功能暂未启用，请联系IT部门人员')}})}})(jQuery);